<!DOCTYPE html><html lang=en><head><title>Pwn2Own Austin 2021 - Defeating the Netgear R6700v3</title><meta charset=UTF-8><meta name=viewport content="width=device-width"><meta name=description content="A writeup on how we got remote code execution on the Netgear R6700v3 during Pwn2Own."><meta name=author content="Antide Petit"><link rel=stylesheet type=text/css href=/static/css/style.css><link rel=stylesheet type=text/css href=/static/css/native.css></head><body><main><nav><ul><li><a href=/ >Index</a></li><li><a href=/b>Blog</a></li><li><a href=https://github.com/xarkes>Git</a></li><li><a href=https://twitter.com/xarkes_>Twitter</a></li></ul></nav><article><h1><a href=/b/pwn2own-2021-netgear.html>Pwn2Own Austin 2021 - Defeating the Netgear R6700v3</a></h1><p class=meta>Published on 03 Apr 2022</p><p>Pwn2Own is a famous computer hacking contest which helds twice a year. It provides various targets for which hackers compete in order to hack them and get unprivileged access to it. It may feature industrial devices, routers, printers, smartphones or even cars and targets change for each event.</p><p>With a coworker of mine we took a glance at the Netgear R6700v3 and this blogpost is a quick recap on what we did. You can read our complete writeup <a href=https://www.synacktiv.com/publications/pwn2own-austin-2021-defeating-the-netgear-r6700v3.html>here</a>.</p><p>Basically there was a stack buffer overflow on a service which is being executed once during boot and once every 2 hours. The service downloads a file and parses it, and the vulnerability relies in the parser. If a malicious entity which could MitM the WAN side (in order to redirect a specific URL to their own), they could have used this vulnerability to take over your router.</p><p>A funny thing is that this is possible because the software inside uses <code>curl</code> to download the file to parse using the <code>-k</code> option... From the manual:</p><div class=codehilite><pre><span></span><code>       -k, --insecure
              (TLS  SFTP  SCP)  By  default,  every  secure connection curl makes is verified to be secure before the transfer takes
              place. This option makes curl skip the verification step and proceed without checking.
</code></pre></div><p>The stack overflow was rather trivial to exploit as there was only partial ASLR, no PIE and no stack cookie. This is really astonishing that in 2021 such devices with so poor security mitigations are sold at a rather huge price (this router costs around <a href=https://www.amazon.fr/NETGEAR-Routeur-intelligent-Nighthawk-R6700/dp/B07NDBD9R6>115€</a>.</p><p>When writing this I just realised that Amazon even promotes it with their "compatible with Alexa".</p><p>Anyways it was a fun experience, I definitely recommend it!</p></article><hr></main><footer> 2024 - Antide Petit aka <a href=/ >xarkes</a> - <a href=https://creativecommons.org/licenses/by-sa/4.0/ >CC-BY-SA</a> - Made with ❤️ </footer></body></html>